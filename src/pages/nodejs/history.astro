---
import Reveal from '../../layouts/Reveal.astro';
import { RunKitEmbed } from '../../components';
import ReactTemplate from '../../components/NodejsSsr/ReactTemplate.astro';
---

<Reveal title="Node.js çš„å‰ä¸–ä»Šç”Ÿ">
  <section>
    <iconify-icon class="text-[16rem]" icon="logos:nodejs" />
    <h2>Node.js å‰ä¸–ä»Šç”Ÿ</h2>
  </section>

  <section>
    <h2>
      <a target="_blank" href="https://nodejs.org">Node.js</a>
    </h2>
    <p class="text-2xl">
      Node.jsÂ® is a JavaScript runtime built on Chrome's V8 JavaScript engine.
    </p>
    <p>æåˆ° Node.js, ç»•ä¸è¿‡ JavaScript.</p>
  </section>

  <section data-auto-animate>
    <iconify-icon class="text-[16rem]" icon="logos:javascript" />
    <h2>JavaScript</h2>
    <p>December 4, 1995</p>
    <div class="flex justify-center items-center gap-8">
      <iconify-icon
        class="text-7xl"
        icon="openmoji:netscape-navigator"
        data-id="netscape-navigator"
      />
      <iconify-icon class="text-7xl" icon="logos:opera" data-id="opera" />
      <iconify-icon
        class="text-7xl"
        icon="logos:internetexplorer"
        data-id="internetexplorer"
      />
      <iconify-icon class="text-7xl" icon="logos:firefox" data-id="firefox" />
      <iconify-icon class="text-7xl" icon="logos:safari" data-id="safari" />
      <iconify-icon class="text-7xl" icon="logos:chrome" data-id="chrome" />
      <iconify-icon
        class="text-7xl"
        icon="logos:microsoft-edge"
        data-id="microsoft-edge"
      />
    </div>
  </section>

  <section data-auto-animate>
    <div class="flex flex-col justify-center items-center gap-8">
      <table class="table text-2xl">
        <tbody>
          <tr class="hover">
            <td
              ><iconify-icon
                class="text-7xl"
                icon="openmoji:netscape-navigator"
                data-id="netscape-navigator"
              />
              <iconify-icon
                class="text-7xl"
                icon="logos:firefox"
                data-id="firefox"
              />
            </td>
            <td>SpiderMonkey</td>
          </tr>
          <tr class="hover">
            <td
              ><iconify-icon
                class="text-7xl"
                icon="logos:internetexplorer"
                data-id="internetexplorer"
              />
            </td>
            <td>Chakra</td>
          </tr>
          <tr class="hover">
            <td
              ><iconify-icon
                class="text-7xl"
                icon="logos:safari"
                data-id="safari"
              />
            </td>
            <td>JavaScriptCore</td>
          </tr>
          <tr class="hover">
            <td
              ><iconify-icon
                class="text-7xl"
                icon="logos:chrome"
                data-id="chrome"
              />
              <iconify-icon
                class="text-7xl"
                icon="logos:opera"
                data-id="opera"
              />
              <iconify-icon
                class="text-7xl"
                icon="logos:microsoft-edge"
                data-id="microsoft-edge"
              />
            </td>
            <td>V8</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <section>
    <section>
      <h2>ry</h2>
      <p>2009</p>
      <p>
        <a
          target="_blank"
          href="https://github.com/nodejs/node/tree/main/deps/v8"
          ><iconify-icon icon="logos:chrome" />
        </a>
        <iconify-icon icon="line-md:plus" />
        <a target="_blank" href="https://github.com/nodejs/node/tree/main/src"
          ><iconify-icon icon="gg:c-plus-plus" />
        </a>
        <iconify-icon icon="line-md:arrow-right" />
        <a
          target="_blank"
          href="https://groups.google.com/g/nodejs/c/6005jwTSoxY/m/u0XvacbwmukJ"
          ><iconify-icon icon="logos:nodejs-icon" />
        </a>
      </p>
      <ul>
        <li>V8 å¾ˆå¿«, å¾ˆä¸“ä¸š.</li>
        <li>V8 æ˜¯ç”¨ C++ å†™çš„.</li>
      </ul>
      <p class="text-sm text-base-content">
        å†å²ä¸Šæ›¾ç»å‡ºç°è¿‡è¿è¡Œåœ¨ JVM ä¸Šçš„ Rhino, .Net ä¸Šçš„ JScript, ä»¥åŠå…¶ä»–<a
          target="_blank"
          href="https://en.wikipedia.org/wiki/List_of_server-side_JavaScript_implementations"
          >äº”èŠ±å…«é—¨çš„å®ç°</a
        >.
      </p>
    </section>

    <section>
      <h5>Node.js</h5>
      <p>
        <iconify-icon icon="logos:chrome" />
        <iconify-icon icon="line-md:plus" />
        <iconify-icon icon="gg:c-plus-plus" />
        <iconify-icon icon="line-md:arrow-right" />
        <iconify-icon icon="logos:nodejs-icon" />
      </p>
      <h5>Deno</h5>
      <p>
        <iconify-icon icon="logos:chrome" />
        <iconify-icon icon="line-md:plus" />
        <iconify-icon icon="vscode-icons:file-type-rust" />
        <iconify-icon icon="line-md:arrow-right" />
        <iconify-icon icon="logos:deno" />
      </p>
      <h5>Bun</h5>
      <p>
        <iconify-icon icon="logos:safari" />
        <iconify-icon icon="line-md:plus" />
        <iconify-icon icon="vscode-icons:file-type-zig" />
        <iconify-icon icon="line-md:arrow-right" />
        <iconify-icon icon="logos:bun" />
      </p>
    </section>
  </section>

  <section>
    <section>
      <h2>
        <a
          target="_blank"
          href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference"
          >JavaScript reference</a
        >
      </h2>
      <ul>
        <li>Built-ins</li>
        <li>Statements</li>
        <li>Expressions and operators</li>
        <li>Functions</li>
        <li>Classes</li>
        <li>Additional reference pages</li>
      </ul>
      <pre><code data-trim data-line-numbers>{`
        /* https://tc39.es */

        @Get('/users') getUsers() {};
      `}</code>
    </pre>
    </section>

    <section>
      <a target="_blank" href="https://github.com/tc39/proposal-do-expressions"
        >tc39/proposal-do-expressions</a
      >
      <pre><code data-trim data-line-numbers>{`
        let result = do {
          let v = f();
          v * v + 1
        };
      `}</code></pre>
    </section>

    <section>
      <a
        target="_blank"
        href="https://github.com/tc39/proposal-pipeline-operator"
        >tc39/proposal-pipeline-operator</a
      >
      <pre><code data-trim data-line-numbers>{`
        let data = url
          |> await fetch
          |> await %.json();
      `}</code></pre>
    </section>

    <section>
      <a
        target="_blank"
        href="https://github.com/tc39/proposal-pattern-matching"
        >tc39/proposal-pattern-matching</a
      >
      <pre><code data-trim data-line-numbers>{`
        const res = await fetch(api);
        match (res) {
          when ({
            status: 200, headers: { 'Content-Length': size }
          }):
            console.log('size is', size);
          when ({ status: 404 }):
            console.log('API not found');
          when ({ status }) if (status >= 400): do {
            throw new RequestError(res);
          }
        };
      `}</code></pre>
    </section>
  </section>

  <section>
    <h2>
      <a target="_blank" href="https://developer.mozilla.org/en-US/docs/Web/API"
        >Web API</a
      >
    </h2>
    <p>
      Web API æ˜¯ç”¨äºå¼€å‘ Web æ—¶ä½¿ç”¨çš„æµè§ˆå™¨æ¥å£, å®ƒä»¬ä¸æ˜¯ JavaScript
      çš„å¿…è¦ç»„æˆéƒ¨åˆ†. ä¾‹å¦‚:
    </p>
    <ul>
      <li><code>window.getSelection</code></li>
      <li><code>document.getElementById</code></li>
      <li><code>location.href</code></li>
      <li><code>localStorage</code></li>
      <li><code>fetch</code></li>
      <li><code>console.log</code></li>
    </ul>
  </section>

  <section>
    <h2>å•çº¯çš„ JavaScript</h2>
    <p>æ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†åº“.</p>
    <p>æœ¬èº«æ²¡æœ‰ IO, å†™ä¸å‡º Hello world.</p>
    <p>ğŸ˜…</p>
  </section>

  <section>
    <h2>ä½ ç¦» Node.js å¾ˆè¿‘</h2>
    <p>æ¯ä¸ªå‰ç«¯çš„ç”µè„‘ä¸Šéƒ½å®‰è£…äº† Node.js.</p>
    <p>å¾ˆå¤š JS ä»£ç èƒ½åœ¨ Node.js é‡Œè·‘èµ·æ¥.</p>
    <div class="flex">
      <img
        class="flex-1 w-1/2 object-contain"
        src="/images/chrome-console.png"
      />
      <img class="flex-1 w-1/2 object-contain" src="/images/node-repl.png" />
    </div>
  </section>

  <section>
    <h2>æ–‡ä»¶æ“ä½œ</h2>
  </section>

  <section>
    <code>ls</code>
    <RunKitEmbed client:visible>
      <code data-trim
        >{
          `
            // #!/usr/bin/env node
            const fs = require('fs/promises');

            const files = await fs.readdir('.')
            const result = files.join('\\n');

            console.log(result);
          `
        }
      </code>
    </RunKitEmbed>
  </section>

  <section>
    <section>
      <h2>æ–‡ä»¶æ“ä½œ</h2>
      <p>è¯»å†™æ–‡ä»¶èƒ½åšå¾ˆå¤šäº‹, ä¾‹å¦‚</p>
      <iconify-icon icon="logos:babel" />
      <pre><code data-trim data-line-numbers>{`
      const fs = require('fs/promises');

      fs.readFile('App.jsx');

      // transform code

      fs.writeFile('App.js');
    `}</code></pre>
    </section>

    <section>
      <h2>JavaScript ç‰ˆæœ¬</h2>
      <p>ECMAScript æ˜¯æ ‡å‡†, JavaScript æ˜¯å®ç°.</p>
      <p>
        ES3 ES5 ES6
        <br />
        <span class="text-success">ES2015</span> ES2016 ... <span
          class="text-info">ES2022</span
        >
        <span class="text-warning">ESNext</span>
      </p>
      <p class="fragment">Babel å¯ä»¥æŠŠé«˜ç‰ˆæœ¬ä»£ç ç¼–è¯‘åˆ°ä½ç‰ˆæœ¬.</p>
      <p class="fragment flex justify-center items-center gap-2">
        <iconify-icon icon="logos:babel" />
        <span class="text-warning">ESNext</span>
        <iconify-icon icon="line-md:arrow-right" />
        <span class="text-success">ES2015</span>
      </p>
    </section>

    <section>
      <h2>å¯¹æ¯”å…¶ä»–è¯­è¨€</h2>
      <ul>
        <li>Python/Go ä½“éªŒæ–°ç‰¹æ€§éœ€è¦å®‰è£… beta ç‰ˆ.</li>
        <li>Java é¡¹ç›®å¾€å¾€åœç•™åœ¨ JDK8.</li>
        <li>.Net framework å¾ˆå¤§, å®‰è£…å¾ˆæ…¢.</li>
      </ul>
    </section>

    <section>
      <h2>ä¸ºä»€ä¹ˆå‰ç«¯éœ€è¦æ„å»º?</h2>
      <ul>
        <li>JS ç¼–è¯‘æ˜¯æŒ‡è¯­æ³•é™çº§.</li>
        <li>å‹ç¼©èŠ‚çœå¸¦å®½.</li>
        <li>æ‰“åŒ…æ˜¯å› ä¸º HTTP 2.0 è¿˜æœªæ™®åŠ.</li>
      </ul>
    </section>
  </section>

  <section>
    <h2>ç½‘ç»œè¯·æ±‚</h2>
  </section>

  <section>
    <section>
      <h2>http server</h2>
      <RunKitEmbed client:visible options={{ mode: 'endpoint' }}>
        <code data-trim
          >{
            `
              const http = require('http');

              const server = http.createServer((req, res) => {
                const time = new Date();
                const json = JSON.stringify({ time });

                res.statusCode = 200;
                res.setHeader('Content-Type', 'application/json');
                res.end(json);
              });

              server.listen(3000);
            `
          }
        </code>
      </RunKitEmbed>
    </section>

    <section>
      <h2>express</h2>
      <RunKitEmbed client:visible options={{ mode: 'endpoint' }}>
        <code data-trim
          >{
            `
              const express = require('express');

              const app = express();

              app.get('/', (req, res) => {
                res.send('<h1>Hello express!</h1>');
              })

              app.listen(3000);
            `
          }
        </code>
      </RunKitEmbed>
    </section>

    <section>
      <h2>koa</h2>
      <RunKitEmbed client:visible options={{ mode: 'endpoint' }}>
        <code data-trim
          >{
            `
              const Koa = require('koa');
              const app = new Koa();

              app.use(async ctx => {
                ctx.body = '<h1>Hello koa!</h1>';
              });

              app.listen(3000);
            `
          }
        </code>
      </RunKitEmbed>
    </section>

    <section
      data-background-image="https://d33wubrfki0l68.cloudfront.net/b48d3f70dffd76bf3152ad04e2cbb1261ef589c9/header.1af6756a.png"
    >
      <h2>Nest</h2>
      <a target="_blank" href="https://nestjs.com">nestjs.com</a>
      <pre><code data-trim>{`
        import { Get, Controller, Render } from '@nestjs/common';
        import { PostsService } from './posts/posts.service';

        @Controller()
        export class AppController {
          constructor(private readonly postsService: PostsService) {}

          @Get('/posts')
          @Render('posts')
          render() {
            const posts = this.postsService.getPosts();
            return { posts };
          }
        }
      `}</code></pre>
    </section>
  </section>

  <section>
    <section>
      <h2>View Templates</h2>
      <p>æŠŠå˜é‡å¡è¿›æ¨¡æ¿, è¾“å‡º HTML.</p>
      <pre><code data-trim>{`
        import ejs from 'ejs';

        const template = '<h1>Hello {<%= name %>!</h1>';

        /* <h1>Hello ejs!</h1> */
        ejs.render(template, { name: 'ejs' });
      `}</code></pre>
      <p>æ‹¼æ¥å­—ç¬¦ä¸²? ç±»ä¼¼, ä½†ä¸å®Œå…¨æ˜¯.</p>
      <pre><code data-trim>{`
        const name = 'world';

        \`<h1>Hello \${name}!</h1>\`;
      `}</code></pre>
    </section>

    <section>
      <p>ejs è¯­æ³•</p>
      <pre><code data-trim>{`
        <!-- æ¡ä»¶ -->
        <% if (user) { %>
          <h2><%= user.name %></h2>
        <% } %>

        <!-- å¾ªç¯ -->
        <ul>
          <% users.forEach(function(user){ %>
            <!-- å¼•ç”¨ -->
            <%- include('user/show', {user: user}); %>
          <% }); %>
        </ul>
      `}</code></pre>
    </section>

    <section>
      <p>pug è¯­æ³•</p>
      <pre><code data-trim>{`
        <!-- ç¼©è¿› -->
        #root.container.m-auto
          h1.text-red Hello pug!
      `}</code></pre>
      <iconify-icon icon="line-md:arrow-down" />
      <pre><code data-trim>{`
        <div id="root" class="container m-auto">
          <h1 class="text-red">Hello pug!</h1>
        </div>
      `}</code></pre>
    </section>

    <section>
      <p>
        å¤šå¦‚ç‰›æ¯›çš„ <a
          target="_blank"
          href="https://github.com/tj/consolidate.js">template engines</a
        >
      </p>
      <pre><code data-trim>{`
        {
          ejs:      '<h1>Hello {<%= name %>!</h1>',
          pug:      'h1 Hello #{ name }!',
          lodash:   '<% _.forEach(l, function(n) { %><li><%- n %></li><% }); %>',
          mustache: '{{title}} spends {{calc}}',
          nunjucks: '{% block nav %} <h1>{{ logo }}</h1> {% endblock %}'
          react:    '<App title={title} />',
        }
      `}</code></pre>
      <p>
        <a
          target="_blank"
          href="https://github.com/jantimon/html-webpack-plugin/blob/main/docs/template-option.md"
          >Html Webpack Plugin ç¤ºä¾‹</a
        >
      </p>
    </section>
  </section>

  <ReactTemplate />

  <section>
    <h2>Next</h2>
    <p><a href="/nodejs/ssr">Server Side Rendering</a></p>
  </section>
</Reveal>
